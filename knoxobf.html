<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>KNOX HEAVY OBF</title>
<style>
body{background:#050505;color:#00ffaa;font-family:Consolas,monospace}
textarea{width:100%;height:220px;background:#080808;color:#00ffaa;border:1px solid #222;padding:10px}
button{margin:8px 0;padding:10px 18px;background:#111;color:#fff;border:1px solid #333}
</style>
</head>
<body>

<h2>KNOX OBFUSCATOR </h2>

<textarea id="src" placeholder="Lua here"></textarea>
<button onclick="go()">OBFUSCATE</button>
<textarea id="out" placeholder="Output"></textarea>
<button onclick="copy()">COPY</button>

<script>
function R(n){
  const c="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
  let s="";
  for(let i=0;i<n;i++)s+=c[Math.random()*c.length|0];
  return s;
}

function enc(s,k){
  let a=[];
  for(let i=0;i<s.length;i++)a.push(s.charCodeAt(i)^k);
  return a;
}

function junkBlock(){
  let t=[];
  for(let i=0;i<60;i++){
    let a=[];
    for(let j=0;j<30;j++)a.push((Math.random()*1e6|0)-(Math.random()*1e6|0));
    t.push("local "+R(7)+"={"+a.join(",")+"}");
  }
  return t.join("\n");
}

function delay(){
  return `
do
  local ${R(6)}=0
  for ${R(5)}=1,${Math.random()*8000+4000|0} do
    ${R(6)}=(${R(6)}+${Math.random()*97|0})%${Math.random()*199+53|0}
  end
end
`;
}

function go(){
  let s=src.value;
  if(!s.trim())return;

  let key=Math.random()*200|0+33;
  let parts=8;
  let size=Math.ceil(s.length/parts);
  let blocks=[];
  let names=[];

  for(let i=0;i<parts;i++){
    let chunk=s.slice(i*size,(i+1)*size);
    let e=enc(chunk,key);
    let n=R(8);
    names.push(n);
    blocks.push(`
${junkBlock()}
local ${n}={${e.join(",")}}
${delay()}
`);
  }

  let recon=names.map(n=>`
for i=1,#${n} do
  ${n}[i]=string.char(${n}[i]~${key})
end
`).join("\n");

  out.value=`
return(function(...)
${junkBlock()}
${blocks.join("\n\n")}
${junkBlock()}

${recon}

${delay()}

local ${R(8)}=${names.join("..")}

${delay()}

local ${R(6)}=(loadstring or load)
${R(6)}(${R(8)})()

${junkBlock()}
end)(...)
`;
}

function copy(){
  out.select();
  document.execCommand("copy");
}
</script>
</body>
</html>

